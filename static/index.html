<!DOCTYPE html>
<html lang="uz">
<head>
  <meta charset="UTF-8">
  <title>Sheva â†’ Adabiy Qidiruv</title>

  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>

  <style>
    body {
      font-family: Arial, sans-serif;
    }
  </style>
</head>

<body
  class="min-h-screen flex items-center justify-center text-gray-800 relative overflow-hidden"
  style="
    background-color: #fde2e4;
    background-image:
      repeating-linear-gradient(
        45deg,
        rgba(255,255,255,0.35),
        rgba(255,255,255,0.35) 1px,
        transparent 1px,
        transparent 18px
      ),
      radial-gradient(circle at 20% 30%, rgba(236,72,153,0.25), transparent 45%),
      radial-gradient(circle at 80% 70%, rgba(251,191,36,0.25), transparent 45%);
  "
>

  <!-- Decorative shapes -->
  <div class="fixed top-10 left-10 w-72 h-72 bg-pink-300/30 rounded-full blur-3xl -z-10"></div>
  <div class="fixed bottom-20 left-20 w-96 h-96 bg-rose-300/30 rounded-full blur-3xl -z-10"></div>
  <div class="fixed top-24 right-16 w-80 h-80 bg-amber-200/40 rounded-full blur-3xl -z-10"></div>

  <!-- Main card -->
  <div class="bg-white/80 backdrop-blur p-8 rounded-3xl shadow-2xl w-[420px] text-center">

    <img
      src="/static/doppi.jpg"
      alt="Uzbek doppi"
      class="w-full h-40 object-cover rounded-2xl mb-5"
    >

    <h2 class="text-2xl font-bold mb-5">ğŸ¤ Shevada gapiring</h2>

    <button
      id="mic"
      class="w-24 h-24 rounded-full bg-pink-400 hover:bg-pink-500 text-white text-4xl flex items-center justify-center mx-auto transition shadow-lg"
    >
      ğŸ™ï¸
    </button>

    <!-- Result -->
    <div id="result" class="mt-6 space-y-3 hidden text-left">
      <div class="bg-pink-50 border border-pink-200 rounded-xl p-3">
        <div class="text-sm text-pink-500 font-semibold">ğŸ—£ Sheva</div>
        <div id="shevaText" class="text-lg font-medium"></div>
      </div>

      <div class="bg-amber-50 border border-amber-200 rounded-xl p-3">
        <div class="text-sm text-amber-600 font-semibold">ğŸ“˜ Adabiy</div>
        <div id="adabiyText" class="text-lg font-medium"></div>
      </div>
    </div>
  </div>

  <!-- Script -->
  <script>
    const micBtn = document.getElementById("mic");
    const resultBox = document.getElementById("result");
    const shevaText = document.getElementById("shevaText");
    const adabiyText = document.getElementById("adabiyText");

    const SpeechRecognition =
      window.SpeechRecognition || window.webkitSpeechRecognition;

    if (!SpeechRecognition) {
      alert("Ğ‘Ñƒ Ğ±Ñ€Ğ°ÑƒĞ·ĞµÑ€ Ğ¾Ğ²Ğ¾Ğ·Ğ½Ğ¸ Ñ‚Ğ°Ğ½Ğ¸Ğ¼Ğ°Ğ¹Ğ´Ğ¸. Chrome Ğ¸ÑˆĞ»Ğ°Ñ‚Ğ¸Ğ½Ğ³.");
    }

    const recognition = new SpeechRecognition();
    recognition.lang = "uz-UZ";
    recognition.interimResults = false;
    recognition.continuous = false;

    micBtn.onclick = () => {
      micBtn.innerText = "ğŸ™ï¸ ...";
      recognition.start();
    };

    recognition.onresult = async (event) => {
      const text = event.results[0][0].transcript;

      micBtn.innerText = "ğŸ™ï¸";
      resultBox.classList.remove("hidden");
      shevaText.innerText = text;
      adabiyText.innerText = "â³ Ñ‚Ğ°Ñ€Ğ¶Ğ¸Ğ¼Ğ° Ò›Ğ¸Ğ»Ğ¸Ğ½Ğ¼Ğ¾Ò›Ğ´Ğ°...";

      try {
        const res = await fetch("/translate_text", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ text })
        });

        const data = await res.json();
        adabiyText.innerText = data.literary_word || "ĞĞ°Ñ‚Ğ¸Ğ¶Ğ° Ñ‚Ğ¾Ğ¿Ğ¸Ğ»Ğ¼Ğ°Ğ´Ğ¸";
      } catch (e) {
        adabiyText.innerText = "âŒ Ğ¡ĞµÑ€Ğ²ĞµÑ€ Ğ±Ğ¸Ğ»Ğ°Ğ½ Ğ±Ğ¾Ò“Ğ»Ğ°Ğ½Ğ¸ÑˆĞ´Ğ° Ñ…Ğ°Ñ‚Ğ¾";
      }
    };

    recognition.onerror = (e) => {
      micBtn.innerText = "ğŸ™ï¸";
      alert("ĞœĞ¸ĞºÑ€Ğ¾Ñ„Ğ¾Ğ½ Ñ…Ğ°Ñ‚Ğ¾ÑĞ¸: " + e.error);
    };
  </script>

</body>
</html>
